library(data.table)
f = function(x,y) fwrite(merge(fread('確診為子宮肌瘤之歸戶代號.csv'),x)[grep('^S49-101|^S49-104|^S49-104P|^S49-111', 收費編號)],y)
f(fread('門診批價明細檔_1.csv')[,-4],'門診超音波_1.csv')
f(fread('門診批價明細檔_2.csv')[,-4],'門診超音波_2.csv')
f(fread('門診批價明細檔_3.csv')[,-4],'門診超音波_3.csv')
f(fread('住診批價明細檔.csv'),'住診超音波.csv')

fwrite(merge(fread('確診為子宮肌瘤之歸戶代號.csv'),fread('門診批價明細檔_1.csv')[,-4])[grep('^S49-101|^S49-104|^S49-104P|^S49-111', 收費編號)],'門診超音波_1.csv')
fwrite(merge(fread('確診為子宮肌瘤之歸戶代號.csv'),fread('門診批價明細檔_2.csv')[,-4])[grep('^S49-101|^S49-104|^S49-104P|^S49-111', 收費編號)],'門診超音波_2.csv')
fwrite(merge(fread('確診為子宮肌瘤之歸戶代號.csv'),fread('門診批價明細檔_3.csv')[,-4])[grep('^S49-101|^S49-104|^S49-104P|^S49-111', 收費編號)],'門診超音波_3.csv')
fwrite(merge(fread('確診為子宮肌瘤之歸戶代號.csv'),fread('住診批價明細檔.csv')       )[grep('^S49-101|^S49-104|^S49-104P|^S49-111', 收費編號)],'住診超音波.csv')
